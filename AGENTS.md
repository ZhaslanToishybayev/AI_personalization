# Repository Guidelines

## Project Structure & Module Organization
This repository centres on a Spec-Driven workflow. `.specify/templates/` stores canonical Markdown templates and `.specify/scripts/bash/` hosts the automation that drives the lifecycle. Feature work lives in `specs/###-feature-slug/` (generated by the scripts) with `spec.md`, `plan.md`, `tasks.md`, plus optional `research.md`, `data-model.md`, or `contracts/`. Agent prompts reside in `.codex/prompts/` and `.cursor/commands/`; keep them aligned with the latest plan. Code or assets introduced by a feature stay inside its directory unless the plan explicitly promotes a shared location.

## Build, Test, and Development Commands
Use the helper scripts as entry points. `bash .specify/scripts/bash/create-new-feature.sh "Personalization Scoring"` scaffolds the next numbered feature and checks out its branch. `bash .specify/scripts/bash/check-prerequisites.sh --json --include-tasks` confirms that the feature directory contains an approved plan and tasks before implementation. `bash .specify/scripts/bash/update-agent-context.sh` refreshes AGENTS.md and companion agent files after any plan update. When a plan defines framework-specific commands (for example, `npm test` or `pytest`), copy them into `tasks.md` and run them from the working directory noted in the plan.

## Coding Style & Naming Conventions
Branches follow the `###-short-slug` pattern enforced by the scaffolding script. Markdown documents use sentence-case headings, concise bullet lists, and GitHub checkboxes for progress. Bash scripts stay POSIX-friendly with four-space indentation; lint with `shellcheck` before committing changes to `.specify/scripts`. For application code, adopt the formatter and linter named in the feature plan and record any justified exceptions directly in that plan.

## Testing Guidelines
List every planned test in `plan.md` and mirror it in `tasks.md` before writing code. Use the framework declared in the plan (e.g., `pytest`, `vitest`), keep tests alongside the feature directory unless a shared suite is specified, and favour descriptive filenames such as `test_personalization_rules.py`. Capture coverage expectations in the plan and log actual results in the task checklist.

## Commit & Pull Request Guidelines
Start commit subjects with the feature number in imperative mood, for example `001: add segmentation spec outline`, and mention touched documents in the body. Pull requests should link the originating feature spec, summarise plan and test changes, attach relevant logs or screenshots, and include evidence that required commands ran successfully.

## Agent Operations
After any plan or template change, rerun `bash .specify/scripts/bash/update-agent-context.sh` to sync agent files. Keep added guidance concise, and move deprecated instructions into the relevant feature directory for traceability instead of deleting them.
